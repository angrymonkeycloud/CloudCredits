var exports = {};
var CloudCreditsItem = (function () {
    function CloudCreditsItem() {
        this.displayInSummary = false;
    }
    return CloudCreditsItem;
}());
{ CloudCreditsItem };
var CloudCreditsSection = (function () {
    function CloudCreditsSection() {
    }
    return CloudCreditsSection;
}());
{ CloudCreditsSection };
var CopyrightSection = (function () {
    function CopyrightSection() {
    }
    return CopyrightSection;
}());
{ CopyrightSection };

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNsYXNzZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFBQTtRQU1JLHFCQUFnQixHQUFhLEtBQUssQ0FBQztJQUN2QyxDQUFDO0lBQUQsdUJBQUM7QUFBRCxDQVBBLEFBT0MsSUFBQTs7QUFFRDtJQUFBO0lBR0EsQ0FBQztJQUFELDBCQUFDO0FBQUQsQ0FIQSxBQUdDLElBQUE7O0FBRUQ7SUFBQTtJQUtBLENBQUM7SUFBRCx1QkFBQztBQUFELENBTEEsQUFLQyxJQUFBIiwiZmlsZSI6IkNsYXNzZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQ2xvdWRDcmVkaXRzSXRlbXtcclxuXHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB0aXRsZT86IHN0cmluZztcclxuICAgIGxpbms/OiBzdHJpbmc7XHJcbiAgICBsb2dvPzogc3RyaW5nO1xyXG4gICAgZGlzcGxheUluU3VtbWFyeT86IGJvb2xlYW4gPSBmYWxzZTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENsb3VkQ3JlZGl0c1NlY3Rpb257XHJcbiAgICB0aXRsZT86IHN0cmluZztcclxuICAgIGl0ZW1zOiBDbG91ZENyZWRpdHNJdGVtW107XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb3B5cmlnaHRTZWN0aW9uIHtcclxuXHJcbiAgICBidXNpbmVzc05hbWU6IHN0cmluZztcclxuICAgIGRpc2NsYWltZXI/OiBzdHJpbmc7XHJcbiAgICBidXNpbmVzc1dlYnNpdGU/OiBzdHJpbmc7XHJcbn0iXX0=



//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNldHRpbmdzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIiLCJmaWxlIjoiU2V0dGluZ3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb3B5cmlnaHRTZWN0aW9uLCBDbG91ZENyZWRpdHNTZWN0aW9uIH0gZnJvbSBcIi4vQ2xhc3Nlc1wiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDbG91ZENyZWRpdHNTZXR0aW5ncyB7XHJcbiAgICBjb3B5cmlnaHQ6IENvcHlyaWdodFNlY3Rpb247XHJcbiAgICBzZWN0aW9uczogQ2xvdWRDcmVkaXRzU2VjdGlvbltdO1xyXG59Il19

var CloudCredits = (function () {
    function CloudCredits(settings) {
        CloudCredits._settings = this.mergeSettings(settings);
        CloudCredits._element = document.querySelector('.cloudcredits');
        if (CloudCredits._element === null) {
            console.log('Please create an element with class "cloudcredits" to define credits');
            return;
        }
        CloudCredits._legendElement = document.querySelector('.cloudcredits-legend');
        if (CloudCredits._legendElement === null) {
            var legendContent = CloudCredits._element.innerHTML;
            CloudCredits._element.innerHTML = '';
            CloudCredits._legendElement = CloudCredits.createHtmlDiv(CloudCredits.createClassName('legend'), legendContent);
            CloudCredits._element.append(CloudCredits._legendElement);
        }
        CloudCredits._summaryElement = document.querySelector('.cloudcredits-summary');
        if (CloudCredits._summaryElement === null) {
            CloudCredits._summaryElement = CloudCredits.createHtmlDiv(CloudCredits.createClassName('summary'));
            CloudCredits._element.append(CloudCredits._summaryElement);
        }
        CloudCredits._contentElement = document.querySelector('.cloudcredits-content');
        if (CloudCredits._contentElement === null) {
            CloudCredits._contentElement = CloudCredits.createHtmlDiv(CloudCredits.createClassName('content'));
            CloudCredits._element.append(CloudCredits._contentElement);
        }
        CloudCredits.fillInLegend();
        CloudCredits.fillInSummary();
        $(document).on('click', '.cloudcredits-legend', function () {
            CloudCredits.toggleDisplay();
        });
    }
    CloudCredits.fillInLegend = function () {
        var legendContent = this._legendElement.innerHTML;
        if (legendContent === '')
            legendContent = 'Â© ' + this._settings.copyright.businessName;
        this._legendElement.innerHTML = legendContent;
    };
    CloudCredits.fillInSummary = function () {
        for (var _i = 0, _a = this._settings.sections; _i < _a.length; _i++) {
            var section = _a[_i];
            for (var _b = 0, _c = section.items; _b < _c.length; _b++) {
                var item = _c[_b];
                if (!item.displayInSummary)
                    continue;
                var summaryItem = this.createHtmlDiv(CloudCredits.createClassName('summary-item'));
                if (item.title !== undefined)
                    summaryItem.append(this.createHtmlParagraph(undefined, item.title + '\xa0'));
                summaryItem.append(this.generateItemSummaryElement(item));
                summaryItem.append(this.createHtmlParagraph(undefined, '\xa0'));
                CloudCredits._summaryElement.append(summaryItem);
            }
        }
    };
    CloudCredits.fillInContent = function () {
        this._contentElement.append(this.generateCreditsCopyright());
        for (var _i = 0, _a = this._settings.sections; _i < _a.length; _i++) {
            var section = _a[_i];
            var sectionElement = this.createHtmlDiv(this.createClassName('section'));
            this._contentElement.append(sectionElement);
            if (section.title !== undefined)
                sectionElement.append(this.createHtmlDiv(this.createClassName('section-title'), section.title));
            var itemsElement = this.createHtmlDiv(this.createClassName('items'));
            sectionElement.append(itemsElement);
            for (var _b = 0, _c = section.items; _b < _c.length; _b++) {
                var item = _c[_b];
                itemsElement.append(this.generateItemElement(item));
            }
        }
    };
    CloudCredits.toggleDisplay = function () {
        var expandedClass = '_expanded';
        var isExpanded = this._element.classList.contains(expandedClass);
        this.scrollTo(document.querySelector('.cloudcredits-legend'), 200);
        if (!isExpanded) {
            this._summaryElement.innerHTML = '';
            this.fillInContent();
            this._element.classList.add(expandedClass);
        }
        else {
            this._contentElement.innerHTML = '';
            this.fillInSummary();
            this._element.classList.remove(expandedClass);
        }
    };
    CloudCredits.prototype.mergeSettings = function (_settings) {
        if (_settings.copyright === undefined)
            _settings.copyright = { businessName: '{Business Name}' };
        if (_settings.copyright.disclaimer === undefined)
            _settings.copyright.disclaimer = 'All Rights Reserved.';
        return _settings;
    };
    CloudCredits.generateCopyrightSection = function () {
        var main = this.createHtmlDiv(this.createClassName('copyright'));
        main.appendChild(this.createHtmlDiv(this.createClassName('copyright', 'disclaimer'), this._settings.copyright.disclaimer));
        var business = this.createHtmlDiv(this.createClassName('copyright', 'business'));
        main.appendChild(business);
        if (this._settings.copyright.businessName !== undefined)
            business.append(this.createHtmlDiv(this.createClassName('copyright', 'business', 'name'), this._settings.copyright.businessName));
        if (this._settings.copyright.businessWebsite !== undefined)
            business.append(this.createHtmlDiv(this.createClassName('copyright', 'business', 'websiteUrl'), this._settings.copyright.businessWebsite));
        return main;
    };
    CloudCredits.generateCreditsCopyright = function () {
        return this.createHtmlDiv(this.createClassName('credits', 'copyright', 'disclaimer'), this._settings.copyright.disclaimer);
    };
    CloudCredits.generateItemSummaryElement = function (item) {
        if (item.link !== undefined)
            return this.createHtmlAnchor(undefined, item.link, item.name);
        return this.createHtmlParagraph(undefined, item.name);
    };
    CloudCredits.generateItemElement = function (item) {
        var itemElement = this.createHtmlDiv(this.createClassName('item'));
        var contentLement = itemElement;
        if (item.title === undefined)
            item.title = '\xa0';
        contentLement.append(this.createHtmlDiv(this.createClassName('item-title'), item.title));
        if (item.link !== undefined) {
            var linkElement = this.createHtmlAnchor(this.createClassName('item'), item.link);
            contentLement.append(linkElement);
            contentLement = linkElement;
        }
        if (item.logo !== undefined)
            contentLement.append(this.createHtmlImage(this.createClassName('item-logo'), item.logo));
        contentLement.append(this.createHtmlParagraph(this.createClassName('item-name'), item.name));
        return itemElement;
    };
    CloudCredits.createClassName = function () {
        var namingSections = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            namingSections[_i] = arguments[_i];
        }
        var fullClassName = this.baseClassName;
        namingSections.forEach(function (section) {
            fullClassName += '-' + section;
        });
        return fullClassName;
    };
    CloudCredits.createHtmlDiv = function (className, content) {
        var divElement = document.createElement('div');
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlSpan = function (className, content) {
        var divElement = document.createElement('span');
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlParagraph = function (className, content) {
        var divElement = document.createElement('p');
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlAnchor = function (className, link, content) {
        var divElement = document.createElement('a');
        divElement.href = link;
        divElement.target = '_blank';
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlImage = function (className, source) {
        var imageElement = document.createElement('img');
        imageElement.src = source;
        if (className !== undefined)
            imageElement.className = className;
        return imageElement;
    };
    CloudCredits.scrollTo = function (scrollToElement, scrollDuration) {
        var scrollTo = window.pageYOffset + scrollToElement.getBoundingClientRect().top;
        var cosParameter = (window.pageYOffset - scrollTo) / 2, scrollCount = 0, oldTimestamp = window.performance.now();
        function step(newTimestamp) {
            var tsDiff = newTimestamp - oldTimestamp;
            if (tsDiff > 100)
                tsDiff = 30;
            scrollCount += Math.PI / (scrollDuration / tsDiff);
            if (scrollCount >= Math.PI)
                return;
            var moveStep = Math.round(scrollTo + cosParameter + cosParameter * Math.cos(scrollCount));
            window.scrollTo(0, moveStep);
            oldTimestamp = newTimestamp;
            window.requestAnimationFrame(step);
        }
        window.requestAnimationFrame(step);
    };
    CloudCredits.baseClassName = 'cloudcredits';
    return CloudCredits;
}());
{ CloudCredits };
var cloudCredits = function (settings) { return new CloudCredits(settings); };
cloudCredits;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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WSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2QyxDQUFDO1FBRUQsTUFBTSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFyVWMsMEJBQWEsR0FBVyxjQUFjLENBQUM7SUFzVTFELG1CQUFDO0NBMVVELEFBMFVDLElBQUE7U0ExVVksWUFBWTtBQTRVekIsSUFBTSxZQUFZLEdBQUcsVUFBQyxRQUE4QixJQUFLLE9BQUEsSUFBSSxZQUFZLENBQUMsUUFBUSxDQUFDLEVBQTFCLENBQTBCLENBQUM7QUFDcEYsZUFBZSxZQUFZLENBQUMiLCJmaWxlIjoiTWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENsb3VkQ3JlZGl0c1NldHRpbmdzIH0gZnJvbSBcIi4vU2V0dGluZ3NcIjtcclxuaW1wb3J0IHsgQ2xvdWRDcmVkaXRzSXRlbSB9IGZyb20gXCIuL0NsYXNzZXNcIjtcclxuXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIENsb3VkQ3JlZGl0cyB7XHJcbiAgICBcclxuICAgIC8vIFByaXZhdGUgVmFyaWFibGVzXHJcbiAgICBwcml2YXRlIHN0YXRpYyBfc2V0dGluZ3M6IENsb3VkQ3JlZGl0c1NldHRpbmdzO1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgYmFzZUNsYXNzTmFtZTogc3RyaW5nID0gJ2Nsb3VkY3JlZGl0cyc7XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2VsZW1lbnQ6IEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBfbGVnZW5kRWxlbWVudDogRWxlbWVudDtcclxuICAgIHByaXZhdGUgc3RhdGljIF9zdW1tYXJ5RWxlbWVudDogRWxlbWVudDtcclxuICAgIHByaXZhdGUgc3RhdGljIF9jb250ZW50RWxlbWVudDogRWxlbWVudDtcclxuXHJcbiAgICAvLyBDb25zdHJ1Y3RvcnNcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3Ioc2V0dGluZ3M6IENsb3VkQ3JlZGl0c1NldHRpbmdzKXtcclxuICAgICAgICBcclxuICAgICAgICBDbG91ZENyZWRpdHMuX3NldHRpbmdzID0gdGhpcy5tZXJnZVNldHRpbmdzKHNldHRpbmdzKTtcclxuXHJcbiAgICAgICAgQ2xvdWRDcmVkaXRzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3VkY3JlZGl0cycpO1xyXG5cclxuICAgICAgICBpZiAoQ2xvdWRDcmVkaXRzLl9lbGVtZW50ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQbGVhc2UgY3JlYXRlIGFuIGVsZW1lbnQgd2l0aCBjbGFzcyBcImNsb3VkY3JlZGl0c1wiIHRvIGRlZmluZSBjcmVkaXRzJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIENsb3VkQ3JlZGl0cy5fbGVnZW5kRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG91ZGNyZWRpdHMtbGVnZW5kJyk7XHJcblxyXG4gICAgICAgIGlmIChDbG91ZENyZWRpdHMuX2xlZ2VuZEVsZW1lbnQgPT09IG51bGwpIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBsZWdlbmRDb250ZW50ID0gQ2xvdWRDcmVkaXRzLl9lbGVtZW50LmlubmVySFRNTDtcclxuICAgICAgICAgICAgQ2xvdWRDcmVkaXRzLl9lbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICBDbG91ZENyZWRpdHMuX2xlZ2VuZEVsZW1lbnQgPSBDbG91ZENyZWRpdHMuY3JlYXRlSHRtbERpdihDbG91ZENyZWRpdHMuY3JlYXRlQ2xhc3NOYW1lKCdsZWdlbmQnKSwgbGVnZW5kQ29udGVudCk7XHJcbiAgICAgICAgICAgIENsb3VkQ3JlZGl0cy5fZWxlbWVudC5hcHBlbmQoQ2xvdWRDcmVkaXRzLl9sZWdlbmRFbGVtZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIENsb3VkQ3JlZGl0cy5fc3VtbWFyeUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvdWRjcmVkaXRzLXN1bW1hcnknKTtcclxuXHJcbiAgICAgICAgaWYgKENsb3VkQ3JlZGl0cy5fc3VtbWFyeUVsZW1lbnQgPT09IG51bGwpIHtcclxuXHJcbiAgICAgICAgICAgIENsb3VkQ3JlZGl0cy5fc3VtbWFyeUVsZW1lbnQgPSBDbG91ZENyZWRpdHMuY3JlYXRlSHRtbERpdihDbG91ZENyZWRpdHMuY3JlYXRlQ2xhc3NOYW1lKCdzdW1tYXJ5JykpO1xyXG4gICAgICAgICAgICBDbG91ZENyZWRpdHMuX2VsZW1lbnQuYXBwZW5kKENsb3VkQ3JlZGl0cy5fc3VtbWFyeUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgQ2xvdWRDcmVkaXRzLl9jb250ZW50RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG91ZGNyZWRpdHMtY29udGVudCcpO1xyXG5cclxuICAgICAgICBpZiAoQ2xvdWRDcmVkaXRzLl9jb250ZW50RWxlbWVudCA9PT0gbnVsbCkge1xyXG5cclxuICAgICAgICAgICAgQ2xvdWRDcmVkaXRzLl9jb250ZW50RWxlbWVudCA9IENsb3VkQ3JlZGl0cy5jcmVhdGVIdG1sRGl2KENsb3VkQ3JlZGl0cy5jcmVhdGVDbGFzc05hbWUoJ2NvbnRlbnQnKSk7XHJcbiAgICAgICAgICAgIENsb3VkQ3JlZGl0cy5fZWxlbWVudC5hcHBlbmQoQ2xvdWRDcmVkaXRzLl9jb250ZW50RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgLy8gU3VtbWFyeVxyXG4gICAgICAgIENsb3VkQ3JlZGl0cy5maWxsSW5MZWdlbmQoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDcmVkaXRzXHJcbiAgICAgICAgQ2xvdWRDcmVkaXRzLmZpbGxJblN1bW1hcnkoKVxyXG5cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNsb3VkY3JlZGl0cy1sZWdlbmQnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgQ2xvdWRDcmVkaXRzLnRvZ2dsZURpc3BsYXkoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmlsbEluTGVnZW5kKCkgOiB2b2lkIHtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgbGVnZW5kQ29udGVudCA9IHRoaXMuX2xlZ2VuZEVsZW1lbnQuaW5uZXJIVE1MO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChsZWdlbmRDb250ZW50ID09PSAnJylcclxuICAgICAgICAgICAgbGVnZW5kQ29udGVudCA9ICfCqSAnICsgdGhpcy5fc2V0dGluZ3MuY29weXJpZ2h0LmJ1c2luZXNzTmFtZTtcclxuXHJcbiAgICAgICAgdGhpcy5fbGVnZW5kRWxlbWVudC5pbm5lckhUTUwgPSBsZWdlbmRDb250ZW50O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIHN0YXRpYyBmaWxsSW5TdW1tYXJ5KCkgOiB2b2lkIHtcclxuICAgICAgICBcclxuICAgICAgICBmb3IoY29uc3Qgc2VjdGlvbiBvZiB0aGlzLl9zZXR0aW5ncy5zZWN0aW9ucylcclxuICAgICAgICAgICAgZm9yKGNvbnN0IGl0ZW0gb2Ygc2VjdGlvbi5pdGVtcylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpdGVtLmRpc3BsYXlJblN1bW1hcnkpXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGxldCBzdW1tYXJ5SXRlbSA9IHRoaXMuY3JlYXRlSHRtbERpdihDbG91ZENyZWRpdHMuY3JlYXRlQ2xhc3NOYW1lKCdzdW1tYXJ5LWl0ZW0nKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0udGl0bGUgIT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5SXRlbS5hcHBlbmQodGhpcy5jcmVhdGVIdG1sUGFyYWdyYXBoKHVuZGVmaW5lZCwgaXRlbS50aXRsZSArICdcXHhhMCcpKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgc3VtbWFyeUl0ZW0uYXBwZW5kKHRoaXMuZ2VuZXJhdGVJdGVtU3VtbWFyeUVsZW1lbnQoaXRlbSkpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzdW1tYXJ5SXRlbS5hcHBlbmQodGhpcy5jcmVhdGVIdG1sUGFyYWdyYXBoKHVuZGVmaW5lZCwgJ1xceGEwJykpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBDbG91ZENyZWRpdHMuX3N1bW1hcnlFbGVtZW50LmFwcGVuZChzdW1tYXJ5SXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmlsbEluQ29udGVudCgpIDogdm9pZCB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29weXJpZ2h0XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fY29udGVudEVsZW1lbnQuYXBwZW5kKHRoaXMuZ2VuZXJhdGVDcmVkaXRzQ29weXJpZ2h0KCkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNlY3Rpb25zXHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCBzZWN0aW9uIG9mIHRoaXMuX3NldHRpbmdzLnNlY3Rpb25zKXtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25FbGVtZW50ID0gdGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdzZWN0aW9uJykpO1xyXG4gICAgICAgICAgICB0aGlzLl9jb250ZW50RWxlbWVudC5hcHBlbmQoc2VjdGlvbkVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHNlY3Rpb24udGl0bGUgIT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgICAgIHNlY3Rpb25FbGVtZW50LmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxEaXYodGhpcy5jcmVhdGVDbGFzc05hbWUoJ3NlY3Rpb24tdGl0bGUnKSwgc2VjdGlvbi50aXRsZSkpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaXRlbXNFbGVtZW50ID0gdGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdpdGVtcycpKTtcclxuICAgICAgICAgICAgICAgIHNlY3Rpb25FbGVtZW50LmFwcGVuZChpdGVtc0VsZW1lbnQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHNlY3Rpb24uaXRlbXMpXHJcbiAgICAgICAgICAgICAgICBpdGVtc0VsZW1lbnQuYXBwZW5kKHRoaXMuZ2VuZXJhdGVJdGVtRWxlbWVudChpdGVtKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzdGF0aWMgdG9nZ2xlRGlzcGxheSgpIDogdm9pZCB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZXhwYW5kZWRDbGFzcyA9ICdfZXhwYW5kZWQnO1xyXG4gICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhleHBhbmRlZENsYXNzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zY3JvbGxUbyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvdWRjcmVkaXRzLWxlZ2VuZCcpLCAyMDApO1xyXG5cclxuICAgICAgICBpZiAoIWlzRXhwYW5kZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3N1bW1hcnlFbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmZpbGxJbkNvbnRlbnQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LmFkZChleHBhbmRlZENsYXNzKVxyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fY29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsbEluU3VtbWFyeSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGV4cGFuZGVkQ2xhc3MpICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgbWVyZ2VTZXR0aW5ncyhfc2V0dGluZ3M6IENsb3VkQ3JlZGl0c1NldHRpbmdzKTogQ2xvdWRDcmVkaXRzU2V0dGluZ3Mge1xyXG5cclxuICAgICAgICBpZiAoX3NldHRpbmdzLmNvcHlyaWdodCA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICBfc2V0dGluZ3MuY29weXJpZ2h0ID0geyBidXNpbmVzc05hbWU6ICd7QnVzaW5lc3MgTmFtZX0nfTtcclxuXHJcbiAgICAgICAgaWYgKF9zZXR0aW5ncy5jb3B5cmlnaHQuZGlzY2xhaW1lciA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICBfc2V0dGluZ3MuY29weXJpZ2h0LmRpc2NsYWltZXIgPSAnQWxsIFJpZ2h0cyBSZXNlcnZlZC4nO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBfc2V0dGluZ3M7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFB1YmxpYyBWYXJpYWJsZXNcclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVDb3B5cmlnaHRTZWN0aW9uKCk6IEhUTUxFbGVtZW50IHtcclxuICAgICAgICBcclxuICAgICAgICAvLyBNYWluIERpdlxyXG4gICAgICAgIGxldCBtYWluID0gdGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdjb3B5cmlnaHQnKSlcclxuICAgICAgICBcclxuICAgICAgICAvLyBDb3B5cmlnaHQgRGlzY2xhaW1lclxyXG4gICAgICAgIG1haW4uYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdjb3B5cmlnaHQnLCAnZGlzY2xhaW1lcicpLCB0aGlzLl9zZXR0aW5ncy5jb3B5cmlnaHQuZGlzY2xhaW1lcikpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEJ1c2luZXNzXHJcbiAgICAgICAgbGV0IGJ1c2luZXNzID0gdGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdjb3B5cmlnaHQnLCAnYnVzaW5lc3MnKSk7XHJcbiAgICAgICAgbWFpbi5hcHBlbmRDaGlsZChidXNpbmVzcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQnVzaW5lc3MgTmFtZVxyXG4gICAgICAgIGlmICh0aGlzLl9zZXR0aW5ncy5jb3B5cmlnaHQuYnVzaW5lc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIGJ1c2luZXNzLmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxEaXYodGhpcy5jcmVhdGVDbGFzc05hbWUoJ2NvcHlyaWdodCcsICdidXNpbmVzcycsICduYW1lJyksIHRoaXMuX3NldHRpbmdzLmNvcHlyaWdodC5idXNpbmVzc05hbWUpKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBCdXNpbmVzcyBXZWJzaXRlIFVybFxyXG4gICAgICAgIGlmICh0aGlzLl9zZXR0aW5ncy5jb3B5cmlnaHQuYnVzaW5lc3NXZWJzaXRlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIGJ1c2luZXNzLmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxEaXYodGhpcy5jcmVhdGVDbGFzc05hbWUoJ2NvcHlyaWdodCcsICdidXNpbmVzcycsICd3ZWJzaXRlVXJsJyksIHRoaXMuX3NldHRpbmdzLmNvcHlyaWdodC5idXNpbmVzc1dlYnNpdGUpKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gbWFpbjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVDcmVkaXRzQ29weXJpZ2h0KCk6IEhUTUxFbGVtZW50e1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUh0bWxEaXYodGhpcy5jcmVhdGVDbGFzc05hbWUoJ2NyZWRpdHMnLCAnY29weXJpZ2h0JywgJ2Rpc2NsYWltZXInKSwgdGhpcy5fc2V0dGluZ3MuY29weXJpZ2h0LmRpc2NsYWltZXIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZUl0ZW1TdW1tYXJ5RWxlbWVudChpdGVtOkNsb3VkQ3JlZGl0c0l0ZW0pOiBIVE1MRWxlbWVudHtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoaXRlbS5saW5rICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUh0bWxBbmNob3IodW5kZWZpbmVkLCBpdGVtLmxpbmssIGl0ZW0ubmFtZSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlSHRtbFBhcmFncmFwaCh1bmRlZmluZWQsIGl0ZW0ubmFtZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlSXRlbUVsZW1lbnQoaXRlbTogQ2xvdWRDcmVkaXRzSXRlbSk6SFRNTEVsZW1lbnRcclxuICAgIHtcclxuICAgICAgICBsZXQgaXRlbUVsZW1lbnQ6IEhUTUxFbGVtZW50ID0gdGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdpdGVtJykpO1xyXG4gICAgICAgIGxldCBjb250ZW50TGVtZW50ID0gaXRlbUVsZW1lbnQ7XHJcblxyXG4gICAgICAgIGlmIChpdGVtLnRpdGxlID09PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIGl0ZW0udGl0bGUgPSAnXFx4YTAnO1xyXG5cclxuICAgICAgICBjb250ZW50TGVtZW50LmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxEaXYodGhpcy5jcmVhdGVDbGFzc05hbWUoJ2l0ZW0tdGl0bGUnKSwgaXRlbS50aXRsZSkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChpdGVtLmxpbmsgIT09IHVuZGVmaW5lZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmtFbGVtZW50ID0gdGhpcy5jcmVhdGVIdG1sQW5jaG9yKHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdpdGVtJyksIGl0ZW0ubGluayk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRMZW1lbnQuYXBwZW5kKGxpbmtFbGVtZW50KTtcclxuICAgICAgICAgICAgY29udGVudExlbWVudCA9IGxpbmtFbGVtZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGl0ZW0ubG9nbyAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIGNvbnRlbnRMZW1lbnQuYXBwZW5kKHRoaXMuY3JlYXRlSHRtbEltYWdlKHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdpdGVtLWxvZ28nKSwgaXRlbS5sb2dvKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29udGVudExlbWVudC5hcHBlbmQodGhpcy5jcmVhdGVIdG1sUGFyYWdyYXBoKHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdpdGVtLW5hbWUnKSwgaXRlbS5uYW1lKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGl0ZW1FbGVtZW50O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgTWV0aG9kc1xyXG4gICAgXHJcbiAgICBwcml2YXRlIHN0YXRpYyBjcmVhdGVDbGFzc05hbWUoLi4ubmFtaW5nU2VjdGlvbnM6IHN0cmluZ1tdKSA6IHN0cmluZ3tcclxuICAgICAgICBsZXQgZnVsbENsYXNzTmFtZSA9IHRoaXMuYmFzZUNsYXNzTmFtZTtcclxuICAgICAgICBcclxuICAgICAgICBuYW1pbmdTZWN0aW9ucy5mb3JFYWNoKChzZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgIGZ1bGxDbGFzc05hbWUgKz0gJy0nICsgc2VjdGlvbjtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZnVsbENsYXNzTmFtZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbERpdihjbGFzc05hbWU6IHN0cmluZywgY29udGVudD86IHN0cmluZyB8IE5vZGUpOkhUTUxEaXZFbGVtZW50e1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBkaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIGRpdkVsZW1lbnQuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChjb250ZW50ICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5hcHBlbmQoY29udGVudCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGRpdkVsZW1lbnQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGNyZWF0ZUh0bWxTcGFuKGNsYXNzTmFtZTogc3RyaW5nLCBjb250ZW50Pzogc3RyaW5nIHwgTm9kZSk6IEhUTUxTcGFuRWxlbWVudHtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICBkaXZFbGVtZW50LmFwcGVuZChjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGl2RWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbFBhcmFncmFwaChjbGFzc05hbWU6IHN0cmluZywgY29udGVudD86IHN0cmluZyB8IE5vZGUpOiBIVE1MUGFyYWdyYXBoRWxlbWVudHtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICBkaXZFbGVtZW50LmFwcGVuZChjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGl2RWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbEFuY2hvcihjbGFzc05hbWU6IHN0cmluZywgbGluazogc3RyaW5nLCBjb250ZW50Pzogc3RyaW5nIHwgTm9kZSk6IEhUTUxBbmNob3JFbGVtZW50e1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBkaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIGRpdkVsZW1lbnQuaHJlZiA9IGxpbms7XHJcbiAgICAgICAgZGl2RWxlbWVudC50YXJnZXQgPSAnX2JsYW5rJztcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICBkaXZFbGVtZW50LmFwcGVuZChjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGl2RWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbEltYWdlKGNsYXNzTmFtZTogc3RyaW5nLCBzb3VyY2U6IHN0cmluZyk6IEhUTUxJbWFnZUVsZW1lbnR7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGltYWdlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICAgIGltYWdlRWxlbWVudC5zcmMgPSBzb3VyY2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIGltYWdlRWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGltYWdlRWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHVibGljIE1ldGhvZHNcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBzY3JvbGxUbyhzY3JvbGxUb0VsZW1lbnQ6IEVsZW1lbnQsIHNjcm9sbER1cmF0aW9uOiBudW1iZXIpOiB2b2lkIHtcclxuXHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG8gPSB3aW5kb3cucGFnZVlPZmZzZXQgKyBzY3JvbGxUb0VsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgLy8gRGVjbGFyYXRpb25zXHJcbiAgICBcclxuICAgICAgICBsZXQgY29zUGFyYW1ldGVyID0gKHdpbmRvdy5wYWdlWU9mZnNldCAtIHNjcm9sbFRvKSAvIDIsXHJcbiAgICAgICAgICAgIHNjcm9sbENvdW50ID0gMCxcclxuICAgICAgICAgICAgb2xkVGltZXN0YW1wID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xyXG4gICAgXHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChuZXdUaW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xyXG4gICAgXHJcbiAgICAgICAgICAgIGxldCB0c0RpZmYgPSBuZXdUaW1lc3RhbXAgLSBvbGRUaW1lc3RhbXA7XHJcbiAgICBcclxuICAgICAgICAgICAgLy8gUGVyZm9ybWFuY2Uubm93KCkgcG9seWZpbGwgbG9hZHMgbGF0ZSBzbyBwYXNzZWQtaW4gdGltZXN0YW1wIGlzIGEgbGFyZ2VyIG9mZnNldFxyXG4gICAgICAgICAgICAvLyBvbiB0aGUgZmlyc3QgZ28tdGhyb3VnaCB0aGFuIHdlIHdhbnQgc28gSSdtIGFkanVzdGluZyB0aGUgZGlmZmVyZW5jZSBkb3duIGhlcmUuXHJcbiAgICAgICAgICAgIC8vIFJlZ2FyZGxlc3MsIHdlIHdvdWxkIHJhdGhlciBoYXZlIGEgc2xpZ2h0bHkgc2xvd2VyIGFuaW1hdGlvbiB0aGFuIGEgYmlnIGp1bXAgc28gYSBnb29kXHJcbiAgICAgICAgICAgIC8vIHNhZmVndWFyZCwgZXZlbiBpZiB3ZSdyZSBub3QgdXNpbmcgdGhlIHBvbHlmaWxsLlxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICh0c0RpZmYgPiAxMDApXHJcbiAgICAgICAgICAgICAgICB0c0RpZmYgPSAzMDtcclxuICAgIFxyXG4gICAgICAgICAgICBzY3JvbGxDb3VudCArPSBNYXRoLlBJIC8gKHNjcm9sbER1cmF0aW9uIC8gdHNEaWZmKTtcclxuICAgIFxyXG4gICAgICAgICAgICAvLyBBcyBzb29uIGFzIHdlIGNyb3NzIG92ZXIgUGksIHdlJ3JlIGFib3V0IHdoZXJlIHdlIG5lZWQgdG8gYmVcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoc2Nyb2xsQ291bnQgPj0gTWF0aC5QSSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgIFxyXG4gICAgICAgICAgICBjb25zdCBtb3ZlU3RlcCA9IE1hdGgucm91bmQoc2Nyb2xsVG8gKyBjb3NQYXJhbWV0ZXIgKyBjb3NQYXJhbWV0ZXIgKiBNYXRoLmNvcyhzY3JvbGxDb3VudCkpO1xyXG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgbW92ZVN0ZXApO1xyXG4gICAgICAgICAgICBvbGRUaW1lc3RhbXAgPSBuZXdUaW1lc3RhbXA7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc3RlcCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShzdGVwKTtcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgY2xvdWRDcmVkaXRzID0gKHNldHRpbmdzOiBDbG91ZENyZWRpdHNTZXR0aW5ncykgPT4gbmV3IENsb3VkQ3JlZGl0cyhzZXR0aW5ncyk7XHJcbmV4cG9ydCBkZWZhdWx0IGNsb3VkQ3JlZGl0czsiXX0=

