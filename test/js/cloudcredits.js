var exports = {};
var CloudCreditsItem = (function () {
    function CloudCreditsItem() {
        this.displayInSummary = false;
    }
    return CloudCreditsItem;
}());
{ CloudCreditsItem };
var CloudCreditsSection = (function () {
    function CloudCreditsSection() {
    }
    return CloudCreditsSection;
}());
{ CloudCreditsSection };
var CopyrightSection = (function () {
    function CopyrightSection() {
    }
    return CopyrightSection;
}());
{ CopyrightSection };

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNsYXNzZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFBQTtRQU9JLHFCQUFnQixHQUFhLEtBQUssQ0FBQztJQUN2QyxDQUFDO0lBQUQsdUJBQUM7QUFBRCxDQVJBLEFBUUMsSUFBQTs7QUFFRDtJQUFBO0lBR0EsQ0FBQztJQUFELDBCQUFDO0FBQUQsQ0FIQSxBQUdDLElBQUE7O0FBRUQ7SUFBQTtJQUtBLENBQUM7SUFBRCx1QkFBQztBQUFELENBTEEsQUFLQyxJQUFBIiwiZmlsZSI6IkNsYXNzZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQ2xvdWRDcmVkaXRzSXRlbXtcclxuXHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB0aXRsZT86IHN0cmluZztcclxuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gICAgbGluaz86IHN0cmluZztcclxuICAgIGxvZ28/OiBzdHJpbmc7XHJcbiAgICBkaXNwbGF5SW5TdW1tYXJ5PzogYm9vbGVhbiA9IGZhbHNlO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ2xvdWRDcmVkaXRzU2VjdGlvbntcclxuICAgIHRpdGxlPzogc3RyaW5nO1xyXG4gICAgaXRlbXM6IENsb3VkQ3JlZGl0c0l0ZW1bXTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvcHlyaWdodFNlY3Rpb24ge1xyXG5cclxuICAgIGJ1c2luZXNzTmFtZTogc3RyaW5nO1xyXG4gICAgZGlzY2xhaW1lcj86IHN0cmluZztcclxuICAgIGJ1c2luZXNzV2Vic2l0ZT86IHN0cmluZztcclxufSJdfQ==



//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNldHRpbmdzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIiLCJmaWxlIjoiU2V0dGluZ3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb3B5cmlnaHRTZWN0aW9uLCBDbG91ZENyZWRpdHNTZWN0aW9uIH0gZnJvbSBcIi4vQ2xhc3Nlc1wiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDbG91ZENyZWRpdHNTZXR0aW5ncyB7XHJcbiAgICBjb3B5cmlnaHQ6IENvcHlyaWdodFNlY3Rpb247XHJcbiAgICBzZWN0aW9uczogQ2xvdWRDcmVkaXRzU2VjdGlvbltdO1xyXG59Il19

var CloudCredits = (function () {
    function CloudCredits(settings) {
        CloudCredits._settings = this.mergeSettings(settings);
        CloudCredits._element = document.querySelector('.cloudcredits');
        if (CloudCredits._element === null) {
            console.log('Please create an element with class "cloudcredits" to define credits');
            return;
        }
        CloudCredits._legendElement = document.querySelector('.cloudcredits-legend');
        if (CloudCredits._legendElement === null) {
            var legendContent = CloudCredits._element.innerHTML;
            CloudCredits._element.innerHTML = '';
            CloudCredits._legendElement = CloudCredits.createHtmlDiv(CloudCredits.createClassName('legend'), legendContent);
            CloudCredits._element.append(CloudCredits._legendElement);
        }
        CloudCredits._summaryElement = document.querySelector('.cloudcredits-summary');
        if (CloudCredits._summaryElement === null) {
            CloudCredits._summaryElement = CloudCredits.createHtmlDiv(CloudCredits.createClassName('summary'));
            CloudCredits._element.append(CloudCredits._summaryElement);
        }
        CloudCredits._contentElement = document.querySelector('.cloudcredits-content');
        if (CloudCredits._contentElement === null) {
            CloudCredits._contentElement = CloudCredits.createHtmlDiv(CloudCredits.createClassName('content'));
            CloudCredits._element.append(CloudCredits._contentElement);
        }
        CloudCredits.fillInLegend();
        CloudCredits.fillInSummary();
        $(document).on('click', '.cloudcredits-legend', function () {
            CloudCredits.toggleDisplay();
        });
    }
    CloudCredits.fillInLegend = function () {
        var legendContent = this._legendElement.innerHTML;
        if (legendContent === '')
            legendContent = 'Â© ' + this._settings.copyright.businessName;
        this._legendElement.innerHTML = legendContent;
    };
    CloudCredits.fillInSummary = function () {
        for (var _i = 0, _a = this._settings.sections; _i < _a.length; _i++) {
            var section = _a[_i];
            for (var _b = 0, _c = section.items; _b < _c.length; _b++) {
                var item = _c[_b];
                if (!item.displayInSummary)
                    continue;
                var summaryItem = this.createHtmlDiv(CloudCredits.createClassName('summary-item'));
                if (item.title !== undefined)
                    summaryItem.append(this.createHtmlParagraph(undefined, item.title + '\xa0'));
                summaryItem.append(this.generateItemSummaryElement(item));
                summaryItem.append(this.createHtmlParagraph(undefined, '\xa0'));
                CloudCredits._summaryElement.append(summaryItem);
            }
        }
    };
    CloudCredits.fillInContent = function () {
        this._contentElement.append(this.generateCreditsCopyright());
        for (var _i = 0, _a = this._settings.sections; _i < _a.length; _i++) {
            var section = _a[_i];
            var sectionElement = this.createHtmlDiv(this.createClassName('section'));
            this._contentElement.append(sectionElement);
            if (section.title !== undefined)
                sectionElement.append(this.createHtmlDiv(this.createClassName('section-title'), section.title));
            var itemsElement = this.createHtmlDiv(this.createClassName('items'));
            sectionElement.append(itemsElement);
            for (var _b = 0, _c = section.items; _b < _c.length; _b++) {
                var item = _c[_b];
                itemsElement.append(this.generateItemElement(item));
            }
        }
    };
    CloudCredits.toggleDisplay = function () {
        var expandedClass = '_expanded';
        var isExpanded = this._element.classList.contains(expandedClass);
        this.scrollTo(document.querySelector('.cloudcredits-legend'), 200);
        if (!isExpanded) {
            this._summaryElement.innerHTML = '';
            this.fillInContent();
            this._element.classList.add(expandedClass);
        }
        else {
            this._contentElement.innerHTML = '';
            this.fillInSummary();
            this._element.classList.remove(expandedClass);
        }
    };
    CloudCredits.prototype.mergeSettings = function (_settings) {
        if (_settings.copyright === undefined)
            _settings.copyright = { businessName: '{Business Name}' };
        if (_settings.copyright.disclaimer === undefined)
            _settings.copyright.disclaimer = 'All Rights Reserved.';
        return _settings;
    };
    CloudCredits.generateCopyrightSection = function () {
        var main = this.createHtmlDiv(this.createClassName('copyright'));
        main.appendChild(this.createHtmlDiv(this.createClassName('copyright', 'disclaimer'), this._settings.copyright.disclaimer));
        var business = this.createHtmlDiv(this.createClassName('copyright', 'business'));
        main.appendChild(business);
        if (this._settings.copyright.businessName !== undefined)
            business.append(this.createHtmlDiv(this.createClassName('copyright', 'business', 'name'), this._settings.copyright.businessName));
        if (this._settings.copyright.businessWebsite !== undefined)
            business.append(this.createHtmlDiv(this.createClassName('copyright', 'business', 'websiteUrl'), this._settings.copyright.businessWebsite));
        return main;
    };
    CloudCredits.generateCreditsCopyright = function () {
        return this.createHtmlDiv(this.createClassName('credits', 'copyright', 'disclaimer'), this._settings.copyright.disclaimer);
    };
    CloudCredits.generateItemSummaryElement = function (item) {
        if (item.link !== undefined)
            return this.createHtmlAnchor(undefined, item.link, item.name);
        return this.createHtmlParagraph(undefined, item.name);
    };
    CloudCredits.generateItemElement = function (item) {
        var itemElement = this.createHtmlDiv(this.createClassName('item'));
        var contentElement = itemElement;
        if (item.title === undefined)
            item.title = '\xa0';
        contentElement.append(this.createHtmlDiv(this.createClassName('item-title'), item.title));
        if (item.link !== undefined) {
            var linkElement = this.createHtmlAnchor(this.createClassName('item'), item.link);
            contentElement.append(linkElement);
            contentElement = linkElement;
        }
        if (item.logo !== undefined)
            contentElement.append(this.createHtmlImage(this.createClassName('item-logo'), item.logo));
        contentElement.append(this.createHtmlParagraph(this.createClassName('item-name'), item.name));
        if (item.description !== undefined)
            itemElement.append(this.createHtmlParagraph(this.createClassName('item-description'), item.description));
        return itemElement;
    };
    CloudCredits.createClassName = function () {
        var namingSections = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            namingSections[_i] = arguments[_i];
        }
        var fullClassName = this.baseClassName;
        namingSections.forEach(function (section) {
            fullClassName += '-' + section;
        });
        return fullClassName;
    };
    CloudCredits.createHtmlDiv = function (className, content) {
        var divElement = document.createElement('div');
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlSpan = function (className, content) {
        var divElement = document.createElement('span');
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlParagraph = function (className, content) {
        var divElement = document.createElement('p');
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlAnchor = function (className, link, content) {
        var divElement = document.createElement('a');
        divElement.href = link;
        divElement.target = '_blank';
        if (className !== undefined)
            divElement.className = className;
        if (content !== undefined)
            divElement.append(content);
        return divElement;
    };
    CloudCredits.createHtmlImage = function (className, source) {
        var imageElement = document.createElement('img');
        imageElement.src = source;
        if (className !== undefined)
            imageElement.className = className;
        return imageElement;
    };
    CloudCredits.scrollTo = function (scrollToElement, scrollDuration) {
        var scrollTo = window.pageYOffset + scrollToElement.getBoundingClientRect().top;
        var cosParameter = (window.pageYOffset - scrollTo) / 2, scrollCount = 0, oldTimestamp = window.performance.now();
        function step(newTimestamp) {
            var tsDiff = newTimestamp - oldTimestamp;
            if (tsDiff > 100)
                tsDiff = 30;
            scrollCount += Math.PI / (scrollDuration / tsDiff);
            if (scrollCount >= Math.PI)
                return;
            var moveStep = Math.round(scrollTo + cosParameter + cosParameter * Math.cos(scrollCount));
            window.scrollTo(0, moveStep);
            oldTimestamp = newTimestamp;
            window.requestAnimationFrame(step);
        }
        window.requestAnimationFrame(step);
    };
    CloudCredits.baseClassName = 'cloudcredits';
    return CloudCredits;
}());
{ CloudCredits };
var cloudCredits = function (settings) { return new CloudCredits(settings); };
cloudCredits;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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LEtBQUssQ0FBQyxRQUFRLEdBQUcsWUFBWSxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDNUYsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDN0IsWUFBWSxHQUFHLFlBQVksQ0FBQztZQUM1QixNQUFNLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkMsQ0FBQztRQUVELE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBeFVjLDBCQUFhLEdBQVcsY0FBYyxDQUFDO0lBeVUxRCxtQkFBQztDQTdVRCxBQTZVQyxJQUFBO1NBN1VZLFlBQVk7QUErVXpCLElBQU0sWUFBWSxHQUFHLFVBQUMsUUFBOEIsSUFBSyxPQUFBLElBQUksWUFBWSxDQUFDLFFBQVEsQ0FBQyxFQUExQixDQUEwQixDQUFDO0FBQ3BGLGVBQWUsWUFBWSxDQUFDIiwiZmlsZSI6Ik1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDbG91ZENyZWRpdHNTZXR0aW5ncyB9IGZyb20gXCIuL1NldHRpbmdzXCI7XHJcbmltcG9ydCB7IENsb3VkQ3JlZGl0c0l0ZW0gfSBmcm9tIFwiLi9DbGFzc2VzXCI7XHJcblxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBDbG91ZENyZWRpdHMge1xyXG4gICAgXHJcbiAgICAvLyBQcml2YXRlIFZhcmlhYmxlc1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX3NldHRpbmdzOiBDbG91ZENyZWRpdHNTZXR0aW5ncztcclxuICAgIHByaXZhdGUgc3RhdGljIGJhc2VDbGFzc05hbWU6IHN0cmluZyA9ICdjbG91ZGNyZWRpdHMnO1xyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIF9lbGVtZW50OiBFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2xlZ2VuZEVsZW1lbnQ6IEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBfc3VtbWFyeUVsZW1lbnQ6IEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBfY29udGVudEVsZW1lbnQ6IEVsZW1lbnQ7XHJcblxyXG4gICAgLy8gQ29uc3RydWN0b3JzXHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHNldHRpbmdzOiBDbG91ZENyZWRpdHNTZXR0aW5ncyl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgQ2xvdWRDcmVkaXRzLl9zZXR0aW5ncyA9IHRoaXMubWVyZ2VTZXR0aW5ncyhzZXR0aW5ncyk7XHJcblxyXG4gICAgICAgIENsb3VkQ3JlZGl0cy5fZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG91ZGNyZWRpdHMnKTtcclxuXHJcbiAgICAgICAgaWYgKENsb3VkQ3JlZGl0cy5fZWxlbWVudCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUGxlYXNlIGNyZWF0ZSBhbiBlbGVtZW50IHdpdGggY2xhc3MgXCJjbG91ZGNyZWRpdHNcIiB0byBkZWZpbmUgY3JlZGl0cycpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBDbG91ZENyZWRpdHMuX2xlZ2VuZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvdWRjcmVkaXRzLWxlZ2VuZCcpO1xyXG5cclxuICAgICAgICBpZiAoQ2xvdWRDcmVkaXRzLl9sZWdlbmRFbGVtZW50ID09PSBudWxsKSB7XHJcblxyXG4gICAgICAgICAgICBsZXQgbGVnZW5kQ29udGVudCA9IENsb3VkQ3JlZGl0cy5fZWxlbWVudC5pbm5lckhUTUw7XHJcbiAgICAgICAgICAgIENsb3VkQ3JlZGl0cy5fZWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgQ2xvdWRDcmVkaXRzLl9sZWdlbmRFbGVtZW50ID0gQ2xvdWRDcmVkaXRzLmNyZWF0ZUh0bWxEaXYoQ2xvdWRDcmVkaXRzLmNyZWF0ZUNsYXNzTmFtZSgnbGVnZW5kJyksIGxlZ2VuZENvbnRlbnQpO1xyXG4gICAgICAgICAgICBDbG91ZENyZWRpdHMuX2VsZW1lbnQuYXBwZW5kKENsb3VkQ3JlZGl0cy5fbGVnZW5kRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBDbG91ZENyZWRpdHMuX3N1bW1hcnlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3VkY3JlZGl0cy1zdW1tYXJ5Jyk7XHJcblxyXG4gICAgICAgIGlmIChDbG91ZENyZWRpdHMuX3N1bW1hcnlFbGVtZW50ID09PSBudWxsKSB7XHJcblxyXG4gICAgICAgICAgICBDbG91ZENyZWRpdHMuX3N1bW1hcnlFbGVtZW50ID0gQ2xvdWRDcmVkaXRzLmNyZWF0ZUh0bWxEaXYoQ2xvdWRDcmVkaXRzLmNyZWF0ZUNsYXNzTmFtZSgnc3VtbWFyeScpKTtcclxuICAgICAgICAgICAgQ2xvdWRDcmVkaXRzLl9lbGVtZW50LmFwcGVuZChDbG91ZENyZWRpdHMuX3N1bW1hcnlFbGVtZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIENsb3VkQ3JlZGl0cy5fY29udGVudEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvdWRjcmVkaXRzLWNvbnRlbnQnKTtcclxuXHJcbiAgICAgICAgaWYgKENsb3VkQ3JlZGl0cy5fY29udGVudEVsZW1lbnQgPT09IG51bGwpIHtcclxuXHJcbiAgICAgICAgICAgIENsb3VkQ3JlZGl0cy5fY29udGVudEVsZW1lbnQgPSBDbG91ZENyZWRpdHMuY3JlYXRlSHRtbERpdihDbG91ZENyZWRpdHMuY3JlYXRlQ2xhc3NOYW1lKCdjb250ZW50JykpO1xyXG4gICAgICAgICAgICBDbG91ZENyZWRpdHMuX2VsZW1lbnQuYXBwZW5kKENsb3VkQ3JlZGl0cy5fY29udGVudEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIC8vIFN1bW1hcnlcclxuICAgICAgICBDbG91ZENyZWRpdHMuZmlsbEluTGVnZW5kKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ3JlZGl0c1xyXG4gICAgICAgIENsb3VkQ3JlZGl0cy5maWxsSW5TdW1tYXJ5KClcclxuXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jbG91ZGNyZWRpdHMtbGVnZW5kJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIENsb3VkQ3JlZGl0cy50b2dnbGVEaXNwbGF5KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGZpbGxJbkxlZ2VuZCgpIDogdm9pZCB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGxlZ2VuZENvbnRlbnQgPSB0aGlzLl9sZWdlbmRFbGVtZW50LmlubmVySFRNTDtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGVnZW5kQ29udGVudCA9PT0gJycpXHJcbiAgICAgICAgICAgIGxlZ2VuZENvbnRlbnQgPSAnwqkgJyArIHRoaXMuX3NldHRpbmdzLmNvcHlyaWdodC5idXNpbmVzc05hbWU7XHJcblxyXG4gICAgICAgIHRoaXMuX2xlZ2VuZEVsZW1lbnQuaW5uZXJIVE1MID0gbGVnZW5kQ29udGVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZmlsbEluU3VtbWFyeSgpIDogdm9pZCB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yKGNvbnN0IHNlY3Rpb24gb2YgdGhpcy5fc2V0dGluZ3Muc2VjdGlvbnMpXHJcbiAgICAgICAgICAgIGZvcihjb25zdCBpdGVtIG9mIHNlY3Rpb24uaXRlbXMpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmICghaXRlbS5kaXNwbGF5SW5TdW1tYXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBsZXQgc3VtbWFyeUl0ZW0gPSB0aGlzLmNyZWF0ZUh0bWxEaXYoQ2xvdWRDcmVkaXRzLmNyZWF0ZUNsYXNzTmFtZSgnc3VtbWFyeS1pdGVtJykpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnRpdGxlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeUl0ZW0uYXBwZW5kKHRoaXMuY3JlYXRlSHRtbFBhcmFncmFwaCh1bmRlZmluZWQsIGl0ZW0udGl0bGUgKyAnXFx4YTAnKSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHN1bW1hcnlJdGVtLmFwcGVuZCh0aGlzLmdlbmVyYXRlSXRlbVN1bW1hcnlFbGVtZW50KGl0ZW0pKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgc3VtbWFyeUl0ZW0uYXBwZW5kKHRoaXMuY3JlYXRlSHRtbFBhcmFncmFwaCh1bmRlZmluZWQsICdcXHhhMCcpKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgQ2xvdWRDcmVkaXRzLl9zdW1tYXJ5RWxlbWVudC5hcHBlbmQoc3VtbWFyeUl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGZpbGxJbkNvbnRlbnQoKSA6IHZvaWQge1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENvcHlyaWdodFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX2NvbnRlbnRFbGVtZW50LmFwcGVuZCh0aGlzLmdlbmVyYXRlQ3JlZGl0c0NvcHlyaWdodCgpKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTZWN0aW9uc1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiB0aGlzLl9zZXR0aW5ncy5zZWN0aW9ucyl7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uRWxlbWVudCA9IHRoaXMuY3JlYXRlSHRtbERpdih0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnc2VjdGlvbicpKTtcclxuICAgICAgICAgICAgdGhpcy5fY29udGVudEVsZW1lbnQuYXBwZW5kKHNlY3Rpb25FbGVtZW50KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWN0aW9uLnRpdGxlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgICAgICBzZWN0aW9uRWxlbWVudC5hcHBlbmQodGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdzZWN0aW9uLXRpdGxlJyksIHNlY3Rpb24udGl0bGUpKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zRWxlbWVudCA9IHRoaXMuY3JlYXRlSHRtbERpdih0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnaXRlbXMnKSk7XHJcbiAgICAgICAgICAgICAgICBzZWN0aW9uRWxlbWVudC5hcHBlbmQoaXRlbXNFbGVtZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBzZWN0aW9uLml0ZW1zKVxyXG4gICAgICAgICAgICAgICAgaXRlbXNFbGVtZW50LmFwcGVuZCh0aGlzLmdlbmVyYXRlSXRlbUVsZW1lbnQoaXRlbSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgc3RhdGljIHRvZ2dsZURpc3BsYXkoKSA6IHZvaWQge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGV4cGFuZGVkQ2xhc3MgPSAnX2V4cGFuZGVkJztcclxuICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoZXhwYW5kZWRDbGFzcyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIHRoaXMuc2Nyb2xsVG8oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3VkY3JlZGl0cy1sZWdlbmQnKSwgMjAwKTtcclxuXHJcbiAgICAgICAgaWYgKCFpc0V4cGFuZGVkKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9zdW1tYXJ5RWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgdGhpcy5maWxsSW5Db250ZW50KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5hZGQoZXhwYW5kZWRDbGFzcylcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRFbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmZpbGxJblN1bW1hcnkoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShleHBhbmRlZENsYXNzKSAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIG1lcmdlU2V0dGluZ3MoX3NldHRpbmdzOiBDbG91ZENyZWRpdHNTZXR0aW5ncyk6IENsb3VkQ3JlZGl0c1NldHRpbmdzIHtcclxuXHJcbiAgICAgICAgaWYgKF9zZXR0aW5ncy5jb3B5cmlnaHQgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgX3NldHRpbmdzLmNvcHlyaWdodCA9IHsgYnVzaW5lc3NOYW1lOiAne0J1c2luZXNzIE5hbWV9J307XHJcblxyXG4gICAgICAgIGlmIChfc2V0dGluZ3MuY29weXJpZ2h0LmRpc2NsYWltZXIgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgX3NldHRpbmdzLmNvcHlyaWdodC5kaXNjbGFpbWVyID0gJ0FsbCBSaWdodHMgUmVzZXJ2ZWQuJztcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gX3NldHRpbmdzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBQdWJsaWMgVmFyaWFibGVzXHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlQ29weXJpZ2h0U2VjdGlvbigpOiBIVE1MRWxlbWVudCB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTWFpbiBEaXZcclxuICAgICAgICBsZXQgbWFpbiA9IHRoaXMuY3JlYXRlSHRtbERpdih0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnY29weXJpZ2h0JykpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29weXJpZ2h0IERpc2NsYWltZXJcclxuICAgICAgICBtYWluLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlSHRtbERpdih0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnY29weXJpZ2h0JywgJ2Rpc2NsYWltZXInKSwgdGhpcy5fc2V0dGluZ3MuY29weXJpZ2h0LmRpc2NsYWltZXIpKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBCdXNpbmVzc1xyXG4gICAgICAgIGxldCBidXNpbmVzcyA9IHRoaXMuY3JlYXRlSHRtbERpdih0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnY29weXJpZ2h0JywgJ2J1c2luZXNzJykpO1xyXG4gICAgICAgIG1haW4uYXBwZW5kQ2hpbGQoYnVzaW5lc3MpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEJ1c2luZXNzIE5hbWVcclxuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3MuY29weXJpZ2h0LmJ1c2luZXNzTmFtZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICBidXNpbmVzcy5hcHBlbmQodGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdjb3B5cmlnaHQnLCAnYnVzaW5lc3MnLCAnbmFtZScpLCB0aGlzLl9zZXR0aW5ncy5jb3B5cmlnaHQuYnVzaW5lc3NOYW1lKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQnVzaW5lc3MgV2Vic2l0ZSBVcmxcclxuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3MuY29weXJpZ2h0LmJ1c2luZXNzV2Vic2l0ZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICBidXNpbmVzcy5hcHBlbmQodGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdjb3B5cmlnaHQnLCAnYnVzaW5lc3MnLCAnd2Vic2l0ZVVybCcpLCB0aGlzLl9zZXR0aW5ncy5jb3B5cmlnaHQuYnVzaW5lc3NXZWJzaXRlKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIG1haW47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlQ3JlZGl0c0NvcHlyaWdodCgpOiBIVE1MRWxlbWVudHtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVIdG1sRGl2KHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdjcmVkaXRzJywgJ2NvcHlyaWdodCcsICdkaXNjbGFpbWVyJyksIHRoaXMuX3NldHRpbmdzLmNvcHlyaWdodC5kaXNjbGFpbWVyKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVJdGVtU3VtbWFyeUVsZW1lbnQoaXRlbTpDbG91ZENyZWRpdHNJdGVtKTogSFRNTEVsZW1lbnR7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGl0ZW0ubGluayAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVIdG1sQW5jaG9yKHVuZGVmaW5lZCwgaXRlbS5saW5rLCBpdGVtLm5hbWUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUh0bWxQYXJhZ3JhcGgodW5kZWZpbmVkLCBpdGVtLm5hbWUpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZUl0ZW1FbGVtZW50KGl0ZW06IENsb3VkQ3JlZGl0c0l0ZW0pOkhUTUxFbGVtZW50XHJcbiAgICB7XHJcbiAgICAgICAgbGV0IGl0ZW1FbGVtZW50OiBIVE1MRWxlbWVudCA9IHRoaXMuY3JlYXRlSHRtbERpdih0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnaXRlbScpKTtcclxuICAgICAgICBsZXQgY29udGVudEVsZW1lbnQgPSBpdGVtRWxlbWVudDtcclxuXHJcbiAgICAgICAgaWYgKGl0ZW0udGl0bGUgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgaXRlbS50aXRsZSA9ICdcXHhhMCc7XHJcblxyXG4gICAgICAgIGNvbnRlbnRFbGVtZW50LmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxEaXYodGhpcy5jcmVhdGVDbGFzc05hbWUoJ2l0ZW0tdGl0bGUnKSwgaXRlbS50aXRsZSkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChpdGVtLmxpbmsgIT09IHVuZGVmaW5lZClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmtFbGVtZW50ID0gdGhpcy5jcmVhdGVIdG1sQW5jaG9yKHRoaXMuY3JlYXRlQ2xhc3NOYW1lKCdpdGVtJyksIGl0ZW0ubGluayk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmFwcGVuZChsaW5rRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50ID0gbGlua0VsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaXRlbS5sb2dvICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxJbWFnZSh0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnaXRlbS1sb2dvJyksIGl0ZW0ubG9nbykpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnRlbnRFbGVtZW50LmFwcGVuZCh0aGlzLmNyZWF0ZUh0bWxQYXJhZ3JhcGgodGhpcy5jcmVhdGVDbGFzc05hbWUoJ2l0ZW0tbmFtZScpLCBpdGVtLm5hbWUpKTtcclxuXHJcbiAgICAgICAgaWYgKGl0ZW0uZGVzY3JpcHRpb24gIT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgaXRlbUVsZW1lbnQuYXBwZW5kKHRoaXMuY3JlYXRlSHRtbFBhcmFncmFwaCh0aGlzLmNyZWF0ZUNsYXNzTmFtZSgnaXRlbS1kZXNjcmlwdGlvbicpLCBpdGVtLmRlc2NyaXB0aW9uKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGl0ZW1FbGVtZW50O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgTWV0aG9kc1xyXG4gICAgXHJcbiAgICBwcml2YXRlIHN0YXRpYyBjcmVhdGVDbGFzc05hbWUoLi4ubmFtaW5nU2VjdGlvbnM6IHN0cmluZ1tdKSA6IHN0cmluZ3tcclxuICAgICAgICBsZXQgZnVsbENsYXNzTmFtZSA9IHRoaXMuYmFzZUNsYXNzTmFtZTtcclxuICAgICAgICBcclxuICAgICAgICBuYW1pbmdTZWN0aW9ucy5mb3JFYWNoKChzZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgIGZ1bGxDbGFzc05hbWUgKz0gJy0nICsgc2VjdGlvbjtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZnVsbENsYXNzTmFtZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbERpdihjbGFzc05hbWU6IHN0cmluZywgY29udGVudD86IHN0cmluZyB8IE5vZGUpOkhUTUxEaXZFbGVtZW50e1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBkaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIGRpdkVsZW1lbnQuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChjb250ZW50ICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5hcHBlbmQoY29udGVudCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGRpdkVsZW1lbnQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc3RhdGljIGNyZWF0ZUh0bWxTcGFuKGNsYXNzTmFtZTogc3RyaW5nLCBjb250ZW50Pzogc3RyaW5nIHwgTm9kZSk6IEhUTUxTcGFuRWxlbWVudHtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICBkaXZFbGVtZW50LmFwcGVuZChjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGl2RWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbFBhcmFncmFwaChjbGFzc05hbWU6IHN0cmluZywgY29udGVudD86IHN0cmluZyB8IE5vZGUpOiBIVE1MUGFyYWdyYXBoRWxlbWVudHtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICBkaXZFbGVtZW50LmFwcGVuZChjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGl2RWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbEFuY2hvcihjbGFzc05hbWU6IHN0cmluZywgbGluazogc3RyaW5nLCBjb250ZW50Pzogc3RyaW5nIHwgTm9kZSk6IEhUTUxBbmNob3JFbGVtZW50e1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBkaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIGRpdkVsZW1lbnQuaHJlZiA9IGxpbms7XHJcbiAgICAgICAgZGl2RWxlbWVudC50YXJnZXQgPSAnX2JsYW5rJztcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgZGl2RWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcclxuICAgICAgICBkaXZFbGVtZW50LmFwcGVuZChjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGl2RWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbEltYWdlKGNsYXNzTmFtZTogc3RyaW5nLCBzb3VyY2U6IHN0cmluZyk6IEhUTUxJbWFnZUVsZW1lbnR7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGltYWdlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICAgIGltYWdlRWxlbWVudC5zcmMgPSBzb3VyY2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIGltYWdlRWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGltYWdlRWxlbWVudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gUHVibGljIE1ldGhvZHNcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBzY3JvbGxUbyhzY3JvbGxUb0VsZW1lbnQ6IEVsZW1lbnQsIHNjcm9sbER1cmF0aW9uOiBudW1iZXIpOiB2b2lkIHtcclxuXHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG8gPSB3aW5kb3cucGFnZVlPZmZzZXQgKyBzY3JvbGxUb0VsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgLy8gRGVjbGFyYXRpb25zXHJcbiAgICBcclxuICAgICAgICBsZXQgY29zUGFyYW1ldGVyID0gKHdpbmRvdy5wYWdlWU9mZnNldCAtIHNjcm9sbFRvKSAvIDIsXHJcbiAgICAgICAgICAgIHNjcm9sbENvdW50ID0gMCxcclxuICAgICAgICAgICAgb2xkVGltZXN0YW1wID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xyXG4gICAgXHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChuZXdUaW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xyXG4gICAgXHJcbiAgICAgICAgICAgIGxldCB0c0RpZmYgPSBuZXdUaW1lc3RhbXAgLSBvbGRUaW1lc3RhbXA7XHJcbiAgICBcclxuICAgICAgICAgICAgLy8gUGVyZm9ybWFuY2Uubm93KCkgcG9seWZpbGwgbG9hZHMgbGF0ZSBzbyBwYXNzZWQtaW4gdGltZXN0YW1wIGlzIGEgbGFyZ2VyIG9mZnNldFxyXG4gICAgICAgICAgICAvLyBvbiB0aGUgZmlyc3QgZ28tdGhyb3VnaCB0aGFuIHdlIHdhbnQgc28gSSdtIGFkanVzdGluZyB0aGUgZGlmZmVyZW5jZSBkb3duIGhlcmUuXHJcbiAgICAgICAgICAgIC8vIFJlZ2FyZGxlc3MsIHdlIHdvdWxkIHJhdGhlciBoYXZlIGEgc2xpZ2h0bHkgc2xvd2VyIGFuaW1hdGlvbiB0aGFuIGEgYmlnIGp1bXAgc28gYSBnb29kXHJcbiAgICAgICAgICAgIC8vIHNhZmVndWFyZCwgZXZlbiBpZiB3ZSdyZSBub3QgdXNpbmcgdGhlIHBvbHlmaWxsLlxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmICh0c0RpZmYgPiAxMDApXHJcbiAgICAgICAgICAgICAgICB0c0RpZmYgPSAzMDtcclxuICAgIFxyXG4gICAgICAgICAgICBzY3JvbGxDb3VudCArPSBNYXRoLlBJIC8gKHNjcm9sbER1cmF0aW9uIC8gdHNEaWZmKTtcclxuICAgIFxyXG4gICAgICAgICAgICAvLyBBcyBzb29uIGFzIHdlIGNyb3NzIG92ZXIgUGksIHdlJ3JlIGFib3V0IHdoZXJlIHdlIG5lZWQgdG8gYmVcclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoc2Nyb2xsQ291bnQgPj0gTWF0aC5QSSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgIFxyXG4gICAgICAgICAgICBjb25zdCBtb3ZlU3RlcCA9IE1hdGgucm91bmQoc2Nyb2xsVG8gKyBjb3NQYXJhbWV0ZXIgKyBjb3NQYXJhbWV0ZXIgKiBNYXRoLmNvcyhzY3JvbGxDb3VudCkpO1xyXG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgbW92ZVN0ZXApO1xyXG4gICAgICAgICAgICBvbGRUaW1lc3RhbXAgPSBuZXdUaW1lc3RhbXA7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc3RlcCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShzdGVwKTtcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgY2xvdWRDcmVkaXRzID0gKHNldHRpbmdzOiBDbG91ZENyZWRpdHNTZXR0aW5ncykgPT4gbmV3IENsb3VkQ3JlZGl0cyhzZXR0aW5ncyk7XHJcbmV4cG9ydCBkZWZhdWx0IGNsb3VkQ3JlZGl0czsiXX0=

